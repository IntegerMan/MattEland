var MattEland=MattEland||{};MattEland.Maps=function(){function t(t,e){var i;i=1===t||3===t||8===t?"BowTie":5===t?"HalfDiamond":"Diamond";var a;return a=1>=e?"Blue":e>=3?"Red":"Yellow","/Images/"+a+i+".png"}function e(t){n.setOptions({visible:!1})}function i(t){"pushpin"===t.targetType?(n.setLocation(t.target.getLocation()),n.setOptions({visible:!0,title:t.target.SeverityName+": "+t.target.Title,description:t.target.Description+" "+t.target.Start+" - "+t.target.End})):e(t)}function a(t){n=new Microsoft.Maps.Infobox(new Microsoft.Maps.Location(0,0),{visible:!1,offset:new Microsoft.Maps.Point(0,0)}),t.entities.push(n)}var n=null;return{addPin:function(e,a,n,o,s,r,c,p,M,d){var l=new Microsoft.Maps.Location(a,n),f=new Microsoft.Maps.Pushpin(l,{text:"",icon:t(d,o),width:16,height:16,draggable:!1});f.Title=r,f.Description=c,f.SeverityName=s,f.Start=p,f.End=M,Microsoft.Maps.Events.addHandler(f,"click",i),e.entities.push(f)},initializeMap:function(t,i,n,o){var s={credentials:t,center:new Microsoft.Maps.Location(i,n),mapTypeId:Microsoft.Maps.MapTypeId.road,zoom:o,showScalebar:!1},r=new Microsoft.Maps.Map(document.getElementById("mapDiv"),s);return a(r),Microsoft.Maps.Events.addHandler(r,"viewchange",e),r}}}();